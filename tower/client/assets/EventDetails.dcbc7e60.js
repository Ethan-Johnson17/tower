import{u as E,p,j as D,k as C,c as _,a as u,o,b as a,d as e,t as r,n as j,F as b,m as k,e as g,A as x}from"./vendor.5f784ede.js";import{_ as S,l,e as h,P as v,A as c}from"./index.5b7d70b7.js";import{a as y}from"./AttendeesService.a1eb1dcd.js";const A={name:"EventDetails",setup(){const i=E();p();const n=D({});return C(async()=>{try{l.log(i.params.id),await h.getById(i.params.id),await y.getEventAttendees(i.params.id)}catch(s){l.error(s),v.toast("Could not get that event","error")}}),{eventDetails:_(()=>c.activeEvent),eventDate:_(()=>new Date(c.activeEvent.startDate).toDateString()),account:_(()=>c.account),attendees:_(()=>c.attendees),attending:_(()=>!!c.attendees.find(t=>t.accountId===c.account.id)),async attendEvent(){try{n.value.accountId=c.account.id,n.value.eventId=i.params.id,l.log("attendee",n.value),await y.attendEvent(n.value),v.toast("Spot Reserved!","success")}catch(s){l.error(s),v.toast("We already saved you a spot!","warning")}},async cancel(){try{if(!await v.confirm("Cancel Event?"))return;const t=i.params.id,m=c.activeEvent;m.isCanceled=!0,l.log("body",m),await h.cancel(t,{update:m})}catch(s){l.error(s),v.toast("Event Canceled","warning")}}}}},I={class:"row border-primary bg-primary justify-content-around"},B={class:"col-md-4"},N=["src"],V={class:"col-md-7 ms-3"},M={class:"row justify-content-between my-3"},R={class:"col-md-8 f-20"},F={class:"col-md-3"},P={class:"row justify-content-between my-3"},W={class:"col-md-5"},L={class:"row justify-content-between my-3"},T={class:"col-md-12"},Y={key:0,class:"row justify-content-between mt-auto"},q={class:"col-md-3"},z={key:0,class:"col-md-3"},G=["disabled"],H={key:1,class:"col-md-3"},J=["disabled"],K={key:2,class:"col-md-3 mb-2"},O=["disabled"],Q={key:3,class:"col-md-5 mt-5 text-end"},U=e("i",{class:"mdi mdi-cancel"},null,-1),X=[U],Z=e("button",{class:"btn btn-warning m-3",title:"Edit Event","data-bs-toggle":"modal","data-bs-target":"#edit"},[e("i",{class:"mdi mdi-pencil"})],-1),$={key:1,class:"row justify-content-center me-2 mb-2"},tt=e("div",{class:"col-md-10 text-center f-20 text-light bg-danger lighten-20 border border-light"},"Event Canceled",-1),et=[tt],nt=e("div",{class:"row justify-content-end me-3"},null,-1),st={class:"row justify-content-center"},ot={class:"col-md-10 my-2 bg-grey darken-20 rounded-3 py-1"},at=["src","title"],ct={class:"row justify-content-center"},dt={class:"col-md-8 text-start"},it=x("What people are saying about ");function rt(i,n,s,t,m,lt){const f=u("Comment"),w=u("EditModal");return o(),a(b,null,[e("div",I,[e("div",B,[e("img",{src:t.eventDetails.coverImg,alt:"Event Cover image",width:"400",class:"mt-3 img-fluid"},null,8,N)]),e("div",V,[e("div",M,[e("div",R,r(t.eventDetails.name),1),e("div",F,r(t.eventDate),1)]),e("div",P,[e("div",W,r(t.eventDetails.location),1)]),e("div",L,[e("div",T,r(t.eventDetails.description),1)]),t.eventDetails.isCanceled===!1?(o(),a("div",Y,[e("div",q,r(t.eventDetails.capacity)+" Spots left",1),t.account.id?t.attending?(o(),a("div",H,[e("button",{class:"btn btn-warning",disabled:!t.account.id||t.attending},"Your spot is saved!",8,J)])):(o(),a("div",K,[e("button",{class:"btn btn-warning",onClick:n[0]||(n[0]=(...d)=>t.attendEvent&&t.attendEvent(...d)),disabled:!t.account.id||t.eventDetails.capacity===0},"Attend",8,O)])):(o(),a("div",z,[e("button",{class:"btn btn-warning",disabled:!t.account.id||t.attending},"Sign in to reserve your spot",8,G)])),t.account.id==t.eventDetails.creatorId?(o(),a("div",Q,[e("button",{class:"btn btn-danger m-3",title:"Cancel Event",onClick:n[1]||(n[1]=(...d)=>t.cancel&&t.cancel(...d))},X),Z])):j("",!0)])):(o(),a("div",$,et)),nt])]),e("div",st,[e("div",ot,[(o(!0),a(b,null,k(t.attendees,d=>(o(),a("img",{src:d.account.picture,alt:"Account pic",class:"rounded-circle",key:d.accountId,height:"35",title:d.account.name},null,8,at))),128))])]),e("div",ct,[e("div",dt,[it,e("b",null,r(t.eventDetails.name),1)]),g(f),g(w)])],64)}var ut=S(A,[["render",rt]]);export{ut as default};
